var Ke=Object.defineProperty;var Ve=(t,e,n)=>e in t?Ke(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var oe=(t,e,n)=>Ve(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function A(){}function qe(t){return t()}function be(){return Object.create(null)}function V(t){t.forEach(qe)}function Ge(t){return typeof t=="function"}function J(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function ze(t){return Object.keys(t).length===0}function u(t,e){t.appendChild(e)}function Q(t,e,n){t.insertBefore(e,n||null)}function O(t){t.parentNode&&t.parentNode.removeChild(t)}function ie(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function ve(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function j(t){return document.createTextNode(t)}function S(){return j(" ")}function Ze(){return j("")}function D(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Je(t){return Array.from(t.childNodes)}function M(t,e){e=""+e,t.data!==e&&(t.data=e)}function ye(t,e){t.value=e??""}function re(t,e,n,l){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function Xe(t,e,{bubbles:n=!1,cancelable:l=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:l})}let le;function ne(t){le=t}function We(){if(!le)throw new Error("Function called outside component initialization");return le}function Ye(t){We().$$.on_mount.push(t)}function ue(){const t=We();return(e,n,{cancelable:l=!1}={})=>{const s=t.$$.callbacks[e];if(s){const i=Xe(e,n,{cancelable:l});return s.slice().forEach(r=>{r.call(t,i)}),!i.defaultPrevented}return!0}}function $e(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(l=>l.call(this,e))}const ee=[],we=[];let te=[];const ke=[],et=Promise.resolve();let fe=!1;function tt(){fe||(fe=!0,et.then(He))}function ce(t){te.push(t)}const ae=new Set;let $=0;function He(){if($!==0)return;const t=le;do{try{for(;$<ee.length;){const e=ee[$];$++,ne(e),nt(e.$$)}}catch(e){throw ee.length=0,$=0,e}for(ne(null),ee.length=0,$=0;we.length;)we.pop()();for(let e=0;e<te.length;e+=1){const n=te[e];ae.has(n)||(ae.add(n),n())}te.length=0}while(ee.length);for(;ke.length;)ke.pop()();fe=!1,ae.clear(),ne(t)}function nt(t){if(t.fragment!==null){t.update(),V(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ce)}}function lt(t){const e=[],n=[];te.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),te=e}const se=new Set;let z;function G(){z={r:0,c:[],p:z}}function W(){z.r||V(z.c),z=z.p}function L(t,e){t&&t.i&&(se.delete(t),t.i(e))}function I(t,e,n,l){if(t&&t.o){if(se.has(t))return;se.add(t),z.c.push(()=>{se.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function H(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Z(t){t&&t.c()}function x(t,e,n){const{fragment:l,after_update:s}=t.$$;l&&l.m(e,n),ce(()=>{const i=t.$$.on_mount.map(qe).filter(Ge);t.$$.on_destroy?t.$$.on_destroy.push(...i):V(i),t.$$.on_mount=[]}),s.forEach(ce)}function K(t,e){const n=t.$$;n.fragment!==null&&(lt(n.after_update),V(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function st(t,e){t.$$.dirty[0]===-1&&(ee.push(t),tt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(t,e,n,l,s,i,r=null,a=[-1]){const o=le;ne(t);const f=t.$$={fragment:null,ctx:[],props:i,update:A,not_equal:s,bound:be(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:be(),dirty:a,skip_bound:!1,root:e.target||o.$$.root};r&&r(f.root);let h=!1;if(f.ctx=n?n(t,e.props||{},(g,w,...c)=>{const d=c.length?c[0]:w;return f.ctx&&s(f.ctx[g],f.ctx[g]=d)&&(!f.skip_bound&&f.bound[g]&&f.bound[g](d),h&&st(t,g)),w}):[],f.update(),h=!0,V(f.before_update),f.fragment=l?l(f.ctx):!1,e.target){if(e.hydrate){const g=Je(e.target);f.fragment&&f.fragment.l(g),g.forEach(O)}else f.fragment&&f.fragment.c();e.intro&&L(t.$$.fragment),x(t,e.target,e.anchor),He()}ne(o)}class Y{constructor(){oe(this,"$$");oe(this,"$$set")}$destroy(){K(this,1),this.$destroy=A}$on(e,n){if(!Ge(n))return A;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const s=l.indexOf(n);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!ze(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const rt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(rt);async function it(){const t=await fetch("/api/tree");if(!t.ok)throw new Error(`Failed to fetch tree: ${t.status}`);return t.json()}async function ot(t){const e=await fetch(`/api/logs?span=${encodeURIComponent(t)}`);if(!e.ok)throw new Error(`Failed to fetch logs: ${e.status}`);return e.json()}async function at(){const t=await fetch("/api/stats");if(!t.ok)throw new Error(`Failed to fetch stats: ${t.status}`);return t.json()}async function ft(t){const e=await fetch(`/api/search?q=${encodeURIComponent(t)}`);if(!e.ok)throw new Error(`Failed to search: ${e.status}`);return e.json()}function Le(t){let e,n,l,s,i=t[0].levels.ERROR+"",r,a;return{c(){e=b("div"),n=b("span"),l=S(),s=b("span"),r=j(i),a=j(" errors"),m(n,"class","w-2 h-2 rounded-full bg-log-error"),m(s,"class","text-log-error font-medium"),m(e,"class","flex items-center gap-1.5")},m(o,f){Q(o,e,f),u(e,n),u(e,l),u(e,s),u(s,r),u(s,a)},p(o,f){f&1&&i!==(i=o[0].levels.ERROR+"")&&M(r,i)},d(o){o&&O(e)}}}function ct(t){let e,n,l,s,i,r=t[0].totalSpans.toLocaleString()+"",a,o,f,h,g,w,c=t[0].totalLogs.toLocaleString()+"",d,_,p=t[0].levels.ERROR>0&&Le(t);return{c(){e=b("div"),n=b("div"),l=b("span"),l.textContent="Spans:",s=S(),i=b("span"),a=j(r),o=S(),f=b("div"),h=b("span"),h.textContent="Logs:",g=S(),w=b("span"),d=j(c),_=S(),p&&p.c(),m(l,"class","text-terminal-muted"),m(i,"class","font-medium"),m(n,"class","flex items-center gap-1.5"),m(h,"class","text-terminal-muted"),m(w,"class","font-medium"),m(f,"class","flex items-center gap-1.5"),m(e,"class","flex items-center gap-4 text-sm")},m(v,k){Q(v,e,k),u(e,n),u(n,l),u(n,s),u(n,i),u(i,a),u(e,o),u(e,f),u(f,h),u(f,g),u(f,w),u(w,d),u(e,_),p&&p.m(e,null)},p(v,[k]){k&1&&r!==(r=v[0].totalSpans.toLocaleString()+"")&&M(a,r),k&1&&c!==(c=v[0].totalLogs.toLocaleString()+"")&&M(d,c),v[0].levels.ERROR>0?p?p.p(v,k):(p=Le(v),p.c(),p.m(e,null)):p&&(p.d(1),p=null)},i:A,o:A,d(v){v&&O(e),p&&p.d()}}}function ut(t,e,n){let{stats:l}=e;return t.$$set=s=>{"stats"in s&&n(0,l=s.stats)},[l]}class dt extends Y{constructor(e){super(),X(this,e,ut,ct,J,{stats:0})}}function Ee(t){let e,n,l;return{c(){e=b("button"),e.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',m(e,"class","absolute right-2 top-1/2 -translate-y-1/2 text-terminal-muted hover:text-terminal-text")},m(s,i){Q(s,e,i),n||(l=D(e,"click",t[5]),n=!0)},p:A,d(s){s&&O(e),n=!1,l()}}}function mt(t){let e,n,l,s,i,r=t[0]&&Ee(t);return{c(){e=b("div"),n=b("input"),l=S(),r&&r.c(),m(n,"type","text"),m(n,"placeholder","Search logs... (Esc to clear)"),m(n,"class","w-full bg-terminal-bg border border-terminal-border rounded px-3 py-1.5 text-sm placeholder-terminal-muted focus:outline-none focus:border-terminal-muted"),m(e,"class","relative flex-1 max-w-md")},m(a,o){Q(a,e,o),u(e,n),ye(n,t[0]),u(e,l),r&&r.m(e,null),s||(i=[D(n,"input",t[4]),D(n,"input",t[2]),D(n,"keydown",t[3])],s=!0)},p(a,[o]){o&1&&n.value!==a[0]&&ye(n,a[0]),a[0]?r?r.p(a,o):(r=Ee(a),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i:A,o:A,d(a){a&&O(e),r&&r.d(),s=!1,V(i)}}}function ht(t,e,n){const l=ue();let s="",i;function r(){clearTimeout(i),i=setTimeout(()=>{l("search",{query:s})},200)}function a(h){h.key==="Escape"&&(n(0,s=""),l("search",{query:""}))}function o(){s=this.value,n(0,s)}return[s,l,r,a,o,()=>{n(0,s=""),l("search",{query:""})}]}class pt extends Y{constructor(e){super(),X(this,e,ht,mt,J,{})}}function Re(t,e,n){var r;const l=t.slice();l[6]=e[n].key,l[7]=e[n].color,l[8]=e[n].label;const s=((r=l[1])==null?void 0:r[l[6]])||0;l[9]=s;const i=l[0][l[6]];return l[10]=i,l}function Se(t){let e,n,l=t[9]+"",s,i;return{c(){e=b("span"),n=j("("),s=j(l),i=j(")"),m(e,"class","text-terminal-muted")},m(r,a){Q(r,e,a),u(e,n),u(e,s),u(e,i)},p(r,a){a&2&&l!==(l=r[9]+"")&&M(s,l)},d(r){r&&O(e)}}}function Ce(t){let e,n,l,s,i,r,a,o,f,h,g=t[9]>0&&Se(t);function w(){return t[4](t[6])}return{c(){e=b("button"),n=b("span"),l=S(),s=b("span"),s.textContent=`${t[8]}`,i=S(),g&&g.c(),r=S(),m(n,"class","w-2 h-2 rounded-full "+t[7]),m(e,"class",a="flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium transition-opacity "+(t[10]?"opacity-100":"opacity-40")),m(e,"title",o=t[6]+": "+t[9]+" entries")},m(c,d){Q(c,e,d),u(e,n),u(e,l),u(e,s),u(e,i),g&&g.m(e,null),u(e,r),f||(h=D(e,"click",w),f=!0)},p(c,d){t=c,t[9]>0?g?g.p(t,d):(g=Se(t),g.c(),g.m(e,r)):g&&(g.d(1),g=null),d&1&&a!==(a="flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium transition-opacity "+(t[10]?"opacity-100":"opacity-40"))&&m(e,"class",a),d&2&&o!==(o=t[6]+": "+t[9]+" entries")&&m(e,"title",o)},d(c){c&&O(e),g&&g.d(),f=!1,h()}}}function gt(t){let e,n=H(t[2]),l=[];for(let s=0;s<n.length;s+=1)l[s]=Ce(Re(t,n,s));return{c(){e=b("div");for(let s=0;s<l.length;s+=1)l[s].c();m(e,"class","flex items-center gap-1")},m(s,i){Q(s,e,i);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(s,[i]){if(i&15){n=H(s[2]);let r;for(r=0;r<n.length;r+=1){const a=Re(s,n,r);l[r]?l[r].p(a,i):(l[r]=Ce(a),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},i:A,o:A,d(s){s&&O(e),ie(l,s)}}}function _t(t,e,n){let{visibleLevels:l}=e,{levels:s={}}=e;const i=ue(),r=[{key:"DEBUG",color:"bg-log-debug",label:"DBG"},{key:"INFO",color:"bg-log-info",label:"INF"},{key:"WARN",color:"bg-log-warn",label:"WRN"},{key:"ERROR",color:"bg-log-error",label:"ERR"}];function a(f){n(0,l={...l,[f]:!l[f]}),i("change",{levels:l})}const o=f=>a(f);return t.$$set=f=>{"visibleLevels"in f&&n(0,l=f.visibleLevels),"levels"in f&&n(1,s=f.levels)},[l,s,r,a,o]}class bt extends Y{constructor(e){super(),X(this,e,_t,gt,J,{visibleLevels:0,levels:1})}}function Oe(t){let e,n;return{c(){e=b("span"),n=j(t[1]),m(e,"class","text-terminal-muted text-xs")},m(l,s){Q(l,e,s),u(e,n)},p(l,s){s&2&&M(n,l[1])},d(l){l&&O(e)}}}function vt(t){let e,n,l,s,i,r,a,o,f=t[0].message+"",h,g,w,c,d=t[1]&&Oe(t);return{c(){e=b("div"),n=b("span"),l=j(t[3]),s=S(),i=b("span"),a=S(),o=b("span"),h=j(f),w=S(),d&&d.c(),m(n,"class","text-terminal-muted text-xs shrink-0"),m(i,"class",r="w-1.5 h-1.5 rounded-full shrink-0 "+t[4].replace("text-","bg-")),m(o,"class",g=t[4]+" "+(t[2]?"font-medium":"")),m(e,"class",c="flex items-baseline gap-2 py-0.5 pl-4 text-sm hover:bg-terminal-surface/50 "+(t[2]?"bg-terminal-surface":""))},m(_,p){Q(_,e,p),u(e,n),u(n,l),u(e,s),u(e,i),u(e,a),u(e,o),u(o,h),u(e,w),d&&d.m(e,null)},p(_,[p]){p&8&&M(l,_[3]),p&16&&r!==(r="w-1.5 h-1.5 rounded-full shrink-0 "+_[4].replace("text-","bg-"))&&m(i,"class",r),p&1&&f!==(f=_[0].message+"")&&M(h,f),p&20&&g!==(g=_[4]+" "+(_[2]?"font-medium":""))&&m(o,"class",g),_[1]?d?d.p(_,p):(d=Oe(_),d.c(),d.m(e,null)):d&&(d.d(1),d=null),p&4&&c!==(c="flex items-baseline gap-2 py-0.5 pl-4 text-sm hover:bg-terminal-surface/50 "+(_[2]?"bg-terminal-surface":""))&&m(e,"class",c)},i:A,o:A,d(_){_&&O(e),d&&d.d()}}}function yt(t,e,n){let l,s,i,r,{log:a}=e,{searchQuery:o=""}=e;const f={DEBUG:"text-log-debug",INFO:"text-log-info",WARN:"text-log-warn",ERROR:"text-log-error"};return t.$$set=h=>{"log"in h&&n(0,a=h.log),"searchQuery"in h&&n(5,o=h.searchQuery)},t.$$.update=()=>{t.$$.dirty&1&&n(4,l=f[a.level]||"text-terminal-text"),t.$$.dirty&1&&n(3,s=a.time?new Date(a.time).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}):""),t.$$.dirty&33&&n(2,i=o&&(a.message.toLowerCase().includes(o.toLowerCase())||Object.values(a.attrs||{}).some(h=>String(h).toLowerCase().includes(o.toLowerCase())))),t.$$.dirty&1&&n(1,r=Object.entries(a.attrs||{}).filter(([h])=>h!=="duration").map(([h,g])=>`${h}=${g}`).join(" "))},[a,r,i,s,l,o]}class wt extends Y{constructor(e){super(),X(this,e,yt,vt,J,{log:0,searchQuery:5})}}function Ie(t,e,n){const l=t.slice();return l[19]=e[n],l}function Qe(t,e,n){const l=t.slice();return l[22]=e[n],l}function kt(t){let e;return{c(){e=b("span"),m(e,"class","w-3")},m(n,l){Q(n,e,l)},p:A,d(n){n&&O(e)}}}function Lt(t){let e,n,l;return{c(){e=ve("svg"),n=ve("path"),m(n,"d","M6 6L14 10L6 14V6Z"),m(e,"class",l="w-3 h-3 transition-transform "+(t[8]?"rotate-90":"")),m(e,"fill","currentColor"),m(e,"viewBox","0 0 20 20")},m(s,i){Q(s,e,i),u(e,n)},p(s,i){i&256&&l!==(l="w-3 h-3 transition-transform "+(s[8]?"rotate-90":""))&&m(e,"class",l)},d(s){s&&O(e)}}}function je(t){let e,n=t[9].duration+"",l;return{c(){e=b("span"),l=j(n),m(e,"class","text-xs text-terminal-muted bg-terminal-bg px-1.5 py-0.5 rounded")},m(s,i){Q(s,e,i),u(e,l)},p(s,i){i&512&&n!==(n=s[9].duration+"")&&M(l,n)},d(s){s&&O(e)}}}function Ne(t){let e,n,l,s=t[10].length>0&&Fe(t),i=t[12]&&Be(t);return{c(){e=b("div"),s&&s.c(),n=S(),i&&i.c(),m(e,"class","ml-4 border-l border-terminal-border"),re(e,"margin-left",t[6]*20+8+"px")},m(r,a){Q(r,e,a),s&&s.m(e,null),u(e,n),i&&i.m(e,null),l=!0},p(r,a){r[10].length>0?s?(s.p(r,a),a&1024&&L(s,1)):(s=Fe(r),s.c(),L(s,1),s.m(e,n)):s&&(G(),I(s,1,1,()=>{s=null}),W()),r[12]?i?(i.p(r,a),a&4096&&L(i,1)):(i=Be(r),i.c(),L(i,1),i.m(e,null)):i&&(G(),I(i,1,1,()=>{i=null}),W()),(!l||a&64)&&re(e,"margin-left",r[6]*20+8+"px")},i(r){l||(L(s),L(i),l=!0)},o(r){I(s),I(i),l=!1},d(r){r&&O(e),s&&s.d(),i&&i.d()}}}function Fe(t){let e,n,l=H(t[10]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Ae(Qe(t,l,r));const i=r=>I(s[r],1,1,()=>{s[r]=null});return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","py-1")},m(r,a){Q(r,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);n=!0},p(r,a){if(a&1040){l=H(r[10]);let o;for(o=0;o<l.length;o+=1){const f=Qe(r,l,o);s[o]?(s[o].p(f,a),L(s[o],1)):(s[o]=Ae(f),s[o].c(),L(s[o],1),s[o].m(e,null))}for(G(),o=l.length;o<s.length;o+=1)i(o);W()}},i(r){if(!n){for(let a=0;a<l.length;a+=1)L(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)I(s[a]);n=!1},d(r){r&&O(e),ie(s,r)}}}function Ae(t){let e,n;return e=new wt({props:{log:t[22],searchQuery:t[4]}}),{c(){Z(e.$$.fragment)},m(l,s){x(e,l,s),n=!0},p(l,s){const i={};s&1024&&(i.log=l[22]),s&16&&(i.searchQuery=l[4]),e.$set(i)},i(l){n||(L(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Be(t){let e,n,l=H(t[9].children),s=[];for(let r=0;r<l.length;r+=1)s[r]=Me(Ie(t,l,r));const i=r=>I(s[r],1,1,()=>{s[r]=null});return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=Ze()},m(r,a){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(r,a);Q(r,e,a),n=!0},p(r,a){if(a&638){l=H(r[9].children);let o;for(o=0;o<l.length;o+=1){const f=Ie(r,l,o);s[o]?(s[o].p(f,a),L(s[o],1)):(s[o]=Me(f),s[o].c(),L(s[o],1),s[o].m(e.parentNode,e))}for(G(),o=l.length;o<s.length;o+=1)i(o);W()}},i(r){if(!n){for(let a=0;a<l.length;a+=1)L(s[a]);n=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)I(s[a]);n=!1},d(r){r&&O(e),ie(s,r)}}}function Me(t){let e,n;return e=new xe({props:{spanId:t[19],spans:t[1],expanded:t[2],visibleLevels:t[3],searchQuery:t[4],matchingSpans:t[5],depth:t[6]+1}}),e.$on("toggle",t[16]),{c(){Z(e.$$.fragment)},m(l,s){x(e,l,s),n=!0},p(l,s){const i={};s&512&&(i.spanId=l[19]),s&2&&(i.spans=l[1]),s&4&&(i.expanded=l[2]),s&8&&(i.visibleLevels=l[3]),s&16&&(i.searchQuery=l[4]),s&32&&(i.matchingSpans=l[5]),s&64&&(i.depth=l[6]+1),e.$set(i)},i(l){n||(L(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Et(t){var de,me,he;let e,n,l,s,i,r=(((de=t[9])==null?void 0:de.name)||t[0])+"",a,o,f,h,g,w=(((me=t[9])==null?void 0:me.logCount)||0)+"",c,d,_,p,v,k,E,N,R,y;function U(C,P){return C[12]||C[7]&&C[7].length>0?Lt:kt}let q=U(t),T=q(t),B=((he=t[9])==null?void 0:he.duration)&&je(t),F=t[8]&&Ne(t);return{c(){e=b("div"),n=b("div"),l=b("span"),T.c(),s=S(),i=b("span"),a=j(r),f=S(),B&&B.c(),h=S(),g=b("span"),c=j(w),d=j(" logs"),_=S(),p=b("span"),v=j(t[0]),E=S(),F&&F.c(),m(l,"class","w-4 h-4 flex items-center justify-center text-terminal-muted"),m(i,"class",o="font-medium "+(t[11]?"text-log-warn":"text-terminal-text")),m(g,"class","text-xs text-terminal-muted opacity-0 group-hover:opacity-100"),m(p,"class","text-xs text-terminal-border opacity-0 group-hover:opacity-100 ml-auto mr-2"),m(n,"class",k="flex items-center gap-1 py-0.5 rounded hover:bg-terminal-surface cursor-pointer group "+(t[11]?"bg-terminal-surface":"")),re(n,"padding-left",t[6]*20+"px"),m(n,"role","button"),m(n,"tabindex","0"),m(e,"class","select-none")},m(C,P){Q(C,e,P),u(e,n),u(n,l),T.m(l,null),u(n,s),u(n,i),u(i,a),u(n,f),B&&B.m(n,null),u(n,h),u(n,g),u(g,c),u(g,d),u(n,_),u(n,p),u(p,v),u(e,E),F&&F.m(e,null),N=!0,R||(y=[D(n,"click",t[13]),D(n,"keydown",t[15])],R=!0)},p(C,[P]){var pe,ge,_e;q===(q=U(C))&&T?T.p(C,P):(T.d(1),T=q(C),T&&(T.c(),T.m(l,null))),(!N||P&513)&&r!==(r=(((pe=C[9])==null?void 0:pe.name)||C[0])+"")&&M(a,r),(!N||P&2048&&o!==(o="font-medium "+(C[11]?"text-log-warn":"text-terminal-text")))&&m(i,"class",o),(ge=C[9])!=null&&ge.duration?B?B.p(C,P):(B=je(C),B.c(),B.m(n,h)):B&&(B.d(1),B=null),(!N||P&512)&&w!==(w=(((_e=C[9])==null?void 0:_e.logCount)||0)+"")&&M(c,w),(!N||P&1)&&M(v,C[0]),(!N||P&2048&&k!==(k="flex items-center gap-1 py-0.5 rounded hover:bg-terminal-surface cursor-pointer group "+(C[11]?"bg-terminal-surface":"")))&&m(n,"class",k),(!N||P&64)&&re(n,"padding-left",C[6]*20+"px"),C[8]?F?(F.p(C,P),P&256&&L(F,1)):(F=Ne(C),F.c(),L(F,1),F.m(e,null)):F&&(G(),I(F,1,1,()=>{F=null}),W())},i(C){N||(L(F),N=!0)},o(C){I(F),N=!1},d(C){C&&O(e),T.d(),B&&B.d(),F&&F.d(),R=!1,V(y)}}}function Rt(t,e,n){let l,s,i,r,a,{spanId:o}=e,{spans:f}=e,{expanded:h}=e,{visibleLevels:g}=e,{searchQuery:w}=e,{matchingSpans:c}=e,{depth:d=0}=e;const _=ue();let p=null,v=!1;async function k(){try{const y=await ot(o);n(7,p=y.logs),n(14,v=!0)}catch(y){console.error(`Failed to load logs for ${o}:`,y)}}function E(){_("toggle",{spanId:o})}const N=y=>y.key==="Enter"&&E();function R(y){$e.call(this,t,y)}return t.$$set=y=>{"spanId"in y&&n(0,o=y.spanId),"spans"in y&&n(1,f=y.spans),"expanded"in y&&n(2,h=y.expanded),"visibleLevels"in y&&n(3,g=y.visibleLevels),"searchQuery"in y&&n(4,w=y.searchQuery),"matchingSpans"in y&&n(5,c=y.matchingSpans),"depth"in y&&n(6,d=y.depth)},t.$$.update=()=>{var y;t.$$.dirty&3&&n(9,l=f[o]),t.$$.dirty&5&&n(8,s=h[o]),t.$$.dirty&512&&n(12,i=((y=l==null?void 0:l.children)==null?void 0:y.length)>0),t.$$.dirty&33&&n(11,r=c.has(o)),t.$$.dirty&16640&&s&&!v&&k(),t.$$.dirty&136&&n(10,a=(p==null?void 0:p.filter(U=>g[U.level]))||[])},[o,f,h,g,w,c,d,p,s,l,a,r,i,E,v,N,R]}class xe extends Y{constructor(e){super(),X(this,e,Rt,Et,J,{spanId:0,spans:1,expanded:2,visibleLevels:3,searchQuery:4,matchingSpans:5,depth:6})}}function Te(t,e,n){const l=t.slice();return l[10]=e[n],l}function Pe(t){let e,n,l,s=t[3].total+"",i,r,a=t[3].total===1?"":"es",o;return{c(){e=b("span"),e.textContent="|",n=S(),l=b("span"),i=j(s),r=j(" match"),o=j(a),m(e,"class","text-terminal-border"),m(l,"class","text-terminal-muted")},m(f,h){Q(f,e,h),Q(f,n,h),Q(f,l,h),u(l,i),u(l,r),u(l,o)},p(f,h){h&8&&s!==(s=f[3].total+"")&&M(i,s),h&8&&a!==(a=f[3].total===1?"":"es")&&M(o,a)},d(f){f&&(O(e),O(n),O(l))}}}function De(t){let e,n;return e=new xe({props:{spanId:t[10],spans:t[0].spans,expanded:t[4],visibleLevels:t[1],searchQuery:t[2],matchingSpans:t[5],depth:0}}),e.$on("toggle",t[9]),{c(){Z(e.$$.fragment)},m(l,s){x(e,l,s),n=!0},p(l,s){const i={};s&1&&(i.spanId=l[10]),s&1&&(i.spans=l[0].spans),s&16&&(i.expanded=l[4]),s&2&&(i.visibleLevels=l[1]),s&4&&(i.searchQuery=l[2]),s&32&&(i.matchingSpans=l[5]),e.$set(i)},i(l){n||(L(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function St(t){let e,n,l,s,i,r,a,o,f,h,g,w,c=t[2]&&t[3]&&Pe(t),d=H(t[0].roots),_=[];for(let v=0;v<d.length;v+=1)_[v]=De(Te(t,d,v));const p=v=>I(_[v],1,1,()=>{_[v]=null});return{c(){e=b("div"),n=b("div"),l=b("button"),l.textContent="Expand all",s=S(),i=b("span"),i.textContent="|",r=S(),a=b("button"),a.textContent="Collapse all",o=S(),c&&c.c(),f=S();for(let v=0;v<_.length;v+=1)_[v].c();m(l,"class","text-terminal-muted hover:text-terminal-text"),m(i,"class","text-terminal-border"),m(a,"class","text-terminal-muted hover:text-terminal-text"),m(n,"class","flex items-center gap-2 mb-3 text-xs"),m(e,"class","space-y-1")},m(v,k){Q(v,e,k),u(e,n),u(n,l),u(n,s),u(n,i),u(n,r),u(n,a),u(n,o),c&&c.m(n,null),u(e,f);for(let E=0;E<_.length;E+=1)_[E]&&_[E].m(e,null);h=!0,g||(w=[D(l,"click",t[7]),D(a,"click",t[8])],g=!0)},p(v,[k]){if(v[2]&&v[3]?c?c.p(v,k):(c=Pe(v),c.c(),c.m(n,null)):c&&(c.d(1),c=null),k&119){d=H(v[0].roots);let E;for(E=0;E<d.length;E+=1){const N=Te(v,d,E);_[E]?(_[E].p(N,k),L(_[E],1)):(_[E]=De(N),_[E].c(),L(_[E],1),_[E].m(e,null))}for(G(),E=d.length;E<_.length;E+=1)p(E);W()}},i(v){if(!h){for(let k=0;k<d.length;k+=1)L(_[k]);h=!0}},o(v){_=_.filter(Boolean);for(let k=0;k<_.length;k+=1)I(_[k]);h=!1},d(v){v&&O(e),c&&c.d(),ie(_,v),g=!1,V(w)}}}function Ct(t,e,n){let l,{tree:s}=e,{visibleLevels:i}=e,{searchQuery:r=""}=e,{searchResults:a=null}=e,o={};function f(c){n(4,o={...o,[c]:!o[c]})}function h(){const c={};for(const d of Object.keys(s.spans))c[d]=!0;n(4,o=c)}function g(){const c={};for(const d of Object.keys(s.spans))c[d]=!1;n(4,o=c)}const w=c=>f(c.detail.spanId);return t.$$set=c=>{"tree"in c&&n(0,s=c.tree),"visibleLevels"in c&&n(1,i=c.visibleLevels),"searchQuery"in c&&n(2,r=c.searchQuery),"searchResults"in c&&n(3,a=c.searchResults)},t.$$.update=()=>{var c;if(t.$$.dirty&17&&s!=null&&s.spans)for(const d of Object.keys(s.spans))o[d]===void 0&&n(4,o[d]=!0,o);t.$$.dirty&8&&n(5,l=new Set(((c=a==null?void 0:a.matches)==null?void 0:c.map(d=>d.span))||[]))},[s,i,r,a,o,l,f,h,g,w]}class Ot extends Y{constructor(e){super(),X(this,e,Ct,St,J,{tree:0,visibleLevels:1,searchQuery:2,searchResults:3})}}function Ue(t){let e,n;return e=new dt({props:{stats:t[1]}}),{c(){Z(e.$$.fragment)},m(l,s){x(e,l,s),n=!0},p(l,s){const i={};s&2&&(i.stats=l[1]),e.$set(i)},i(l){n||(L(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function It(t){let e,n;return e=new Ot({props:{tree:t[0],visibleLevels:t[4],searchQuery:t[5],searchResults:t[6]}}),{c(){Z(e.$$.fragment)},m(l,s){x(e,l,s),n=!0},p(l,s){const i={};s&1&&(i.tree=l[0]),s&16&&(i.visibleLevels=l[4]),s&32&&(i.searchQuery=l[5]),s&64&&(i.searchResults=l[6]),e.$set(i)},i(l){n||(L(e.$$.fragment,l),n=!0)},o(l){I(e.$$.fragment,l),n=!1},d(l){K(e,l)}}}function Qt(t){let e,n,l,s;return{c(){e=b("div"),n=b("div"),l=j("Error: "),s=j(t[3]),m(n,"class","text-log-error"),m(e,"class","flex items-center justify-center h-64")},m(i,r){Q(i,e,r),u(e,n),u(n,l),u(n,s)},p(i,r){r&8&&M(s,i[3])},i:A,o:A,d(i){i&&O(e)}}}function jt(t){let e;return{c(){e=b("div"),e.innerHTML='<div class="text-terminal-muted">Loading...</div>',m(e,"class","flex items-center justify-center h-64")},m(n,l){Q(n,e,l)},p:A,i:A,o:A,d(n){n&&O(e)}}}function Nt(t){var N;let e,n,l,s,i,r,a,o,f,h,g,w,c,d,_,p=t[1]&&Ue(t);o=new pt({}),o.$on("search",t[7]),h=new bt({props:{visibleLevels:t[4],levels:(N=t[1])==null?void 0:N.levels}}),h.$on("change",t[8]);const v=[jt,Qt,It],k=[];function E(R,y){return R[2]?0:R[3]?1:R[0]?2:-1}return~(c=E(t))&&(d=k[c]=v[c](t)),{c(){e=b("div"),n=b("header"),l=b("div"),s=b("h1"),s.innerHTML='<span class="text-terminal-muted">drillog</span> viewer',i=S(),p&&p.c(),r=S(),a=b("div"),Z(o.$$.fragment),f=S(),Z(h.$$.fragment),g=S(),w=b("main"),d&&d.c(),m(s,"class","text-lg font-semibold"),m(l,"class","flex items-center justify-between"),m(n,"class","bg-terminal-surface border-b border-terminal-border px-4 py-3"),m(a,"class","bg-terminal-surface border-b border-terminal-border px-4 py-2 flex items-center gap-4"),m(w,"class","flex-1 overflow-auto p-4"),m(e,"class","min-h-screen flex flex-col")},m(R,y){Q(R,e,y),u(e,n),u(n,l),u(l,s),u(l,i),p&&p.m(l,null),u(e,r),u(e,a),x(o,a,null),u(a,f),x(h,a,null),u(e,g),u(e,w),~c&&k[c].m(w,null),_=!0},p(R,[y]){var T;R[1]?p?(p.p(R,y),y&2&&L(p,1)):(p=Ue(R),p.c(),L(p,1),p.m(l,null)):p&&(G(),I(p,1,1,()=>{p=null}),W());const U={};y&16&&(U.visibleLevels=R[4]),y&2&&(U.levels=(T=R[1])==null?void 0:T.levels),h.$set(U);let q=c;c=E(R),c===q?~c&&k[c].p(R,y):(d&&(G(),I(k[q],1,1,()=>{k[q]=null}),W()),~c?(d=k[c],d?d.p(R,y):(d=k[c]=v[c](R),d.c()),L(d,1),d.m(w,null)):d=null)},i(R){_||(L(p),L(o.$$.fragment,R),L(h.$$.fragment,R),L(d),_=!0)},o(R){I(p),I(o.$$.fragment,R),I(h.$$.fragment,R),I(d),_=!1},d(R){R&&O(e),p&&p.d(),K(o),K(h),~c&&k[c].d()}}}function Ft(t,e,n){let l=null,s=null,i=!0,r=null,a={DEBUG:!0,INFO:!0,WARN:!0,ERROR:!0},o="",f=null;Ye(async()=>{try{n(0,[l,s]=await Promise.all([it(),at()]),l,n(1,s))}catch(w){n(3,r=w.message)}finally{n(2,i=!1)}});async function h(w){if(n(5,o=w.detail.query),o.trim())try{n(6,f=await ft(o))}catch(c){console.error("Search failed:",c),n(6,f=null)}else n(6,f=null)}function g(w){n(4,a=w.detail.levels)}return[l,s,i,r,a,o,f,h,g]}class At extends Y{constructor(e){super(),X(this,e,Ft,Nt,J,{})}}new At({target:document.getElementById("app")});
